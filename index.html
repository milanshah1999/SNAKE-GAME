<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Snake Game</title>
    <style>
        body {
            margin: 0;
            background: linear-gradient(135deg, #4ade80, #3b82f6, #8b5cf6);
            min-height: 100vh;
            font-family: Arial, sans-serif;
        }
        .game-container {
            max-width: 600px;
            margin: 0 auto;
            padding: 20px;
            text-align: center;
        }
        .title {
            color: white;
            font-size: 3rem;
            font-weight: bold;
            margin-bottom: 20px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }
        .score-board {
            background: rgba(255,255,255,0.2);
            backdrop-filter: blur(10px);
            border-radius: 15px;
            padding: 20px;
            margin-bottom: 20px;
            display: flex;
            justify-content: space-around;
        }
        .score {
            color: white;
            font-size: 1.5rem;
            font-weight: bold;
        }
        .game-board {
            background: rgba(0,0,0,0.3);
            border-radius: 15px;
            padding: 10px;
            margin: 20px auto;
            display: inline-block;
        }
        .grid {
            display: grid;
            grid-template-columns: repeat(20, 15px);
            grid-template-rows: repeat(20, 15px);
            gap: 1px;
            background: #1f2937;
            border-radius: 10px;
            padding: 5px;
        }
        .cell {
            width: 15px;
            height: 15px;
            background: #374151;
            border-radius: 2px;
            transition: all 0.1s;
        }
        .snake-head { 
            background: #4ade80 !important; 
            box-shadow: 0 0 5px #4ade80;
        }
        .snake-body { 
            background: #22c55e !important; 
        }
        .food { 
            background: #ef4444 !important; 
            border-radius: 50%;
            animation: pulse 1s infinite;
        }
        
        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.1); }
            100% { transform: scale(1); }
        }
        
        .controls {
            margin: 20px 0;
        }
        .btn {
            background: #3b82f6;
            color: white;
            border: none;
            padding: 15px 30px;
            border-radius: 10px;
            font-size: 1.1rem;
            cursor: pointer;
            margin: 5px;
            transition: all 0.2s;
        }
        .btn:hover {
            background: #2563eb;
            transform: scale(1.05);
        }
        .btn:active {
            transform: scale(0.95);
        }
        
        .mobile-controls {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 10px;
            max-width: 200px;
            margin: 20px auto;
        }
        .arrow-btn {
            background: #3b82f6;
            color: white;
            border: none;
            padding: 15px;
            border-radius: 10px;
            font-size: 1.5rem;
            cursor: pointer;
            transition: all 0.2s;
            user-select: none;
        }
        .arrow-btn:hover {
            background: #2563eb;
        }
        .arrow-btn:active {
            background: #1d4ed8;
            transform: scale(0.9);
        }
        .empty { 
            background: transparent !important; 
            border: none !important;
            pointer-events: none;
        }
        
        .game-over {
            background: rgba(239,68,68,0.2);
            backdrop-filter: blur(10px);
            border-radius: 15px;
            padding: 20px;
            margin: 20px 0;
            color: white;
        }
        
        .instructions {
            background: rgba(255,255,255,0.1);
            backdrop-filter: blur(10px);
            border-radius: 15px;
            padding: 15px;
            margin: 20px 0;
            color: white;
        }
    </style>
</head>
<body>
    <div class="game-container">
        <h1 class="title">üêç Snake Game</h1>
        
        <div class="score-board">
            <div>
                <div style="color: rgba(255,255,255,0.8);">Score</div>
                <div class="score" id="score">0</div>
            </div>
            <div>
                <div style="color: rgba(255,255,255,0.8);">High Score</div>
                <div class="score" id="highScore">0</div>
            </div>
        </div>

        <div class="game-board">
            <div class="grid" id="gameGrid"></div>
        </div>

        <div class="controls">
            <button class="btn" id="startBtn">Start Game</button>
            <button class="btn" id="resetBtn" style="display:none;">Reset Game</button>
        </div>

        <div id="gameOverDiv" class="game-over" style="display:none;">
            <h2>Game Over! üíÄ</h2>
            <p>Final Score: <span id="finalScore">0</span></p>
            <button class="btn" id="playAgainBtn">Play Again</button>
        </div>

        <div class="mobile-controls">
            <div class="empty"></div>
            <button class="arrow-btn" id="upBtn">‚Üë</button>
            <div class="empty"></div>
            <button class="arrow-btn" id="leftBtn">‚Üê</button>
            <div class="empty"></div>
            <button class="arrow-btn" id="rightBtn">‚Üí</button>
            <div class="empty"></div>
            <button class="arrow-btn" id="downBtn">‚Üì</button>
            <div class="empty"></div>
        </div>

        <div class="instructions">
            <h3 style="margin-bottom: 10px;">How to Play</h3>
            <p style="color: rgba(255,255,255,0.8); font-size: 0.9rem; margin: 0;">
                Use arrow keys, WASD, or touch controls to move. Eat red food to grow. Don't hit walls or yourself!
            </p>
        </div>
    </div>

    <script>
        // Game variables
        const GRID_SIZE = 20;
        let snake = [{x: 10, y: 10}];
        let direction = {x: 0, y: -1};
        let food = {x: 15, y: 15};
        let score = 0;
        let gameRunning = false;
        let gameLoop = null;

        // DOM elements
        const scoreElement = document.getElementById('score');
        const highScoreElement = document.getElementById('highScore');
        const startBtn = document.getElementById('startBtn');
        const resetBtn = document.getElementById('resetBtn');
        const gameOverDiv = document.getElementById('gameOverDiv');
        const finalScoreElement = document.getElementById('finalScore');
        const playAgainBtn = document.getElementById('playAgainBtn');
        const gameGrid = document.getElementById('gameGrid');

        // Mobile control buttons
        const upBtn = document.getElementById('upBtn');
        const downBtn = document.getElementById('downBtn');
        const leftBtn = document.getElementById('leftBtn');
        const rightBtn = document.getElementById('rightBtn');

        // Load high score from localStorage
        let highScore = parseInt(localStorage.getItem('snakeHighScore') || '0');
        highScoreElement.textContent = highScore;

        // Create game grid
        function createGrid() {
            gameGrid.innerHTML = '';
            for(let i = 0; i < GRID_SIZE * GRID_SIZE; i++) {
                const cell = document.createElement('div');
                cell.className = 'cell';
                cell.id = `cell-${i}`;
                gameGrid.appendChild(cell);
            }
        }

        // Update the visual display
        function updateDisplay() {
            // Clear all cells
            for(let i = 0; i < GRID_SIZE * GRID_SIZE; i++) {
                const cell = document.getElementById(`cell-${i}`);
                if(cell) {
                    cell.className = 'cell';
                }
            }

            // Draw snake
            snake.forEach((segment, index) => {
                const cellIndex = segment.y * GRID_SIZE + segment.x;
                const cell = document.getElementById(`cell-${cellIndex}`);
                if(cell) {
                    if(index === 0) {
                        cell.className = 'cell snake-head';
                    } else {
                        cell.className = 'cell snake-body';
                    }
                }
            });

            // Draw food
            const foodIndex = food.y * GRID_SIZE + food.x;
            const foodCell = document.getElementById(`cell-${foodIndex}`);
            if(foodCell) {
                foodCell.className = 'cell food';
            }

            // Update score display
            scoreElement.textContent = score;
        }

        // Generate new food position
        function generateFood() {
            do {
                food = {
                    x: Math.floor(Math.random() * GRID_SIZE),
                    y: Math.floor(Math.random() * GRID_SIZE)
                };
            } while(snake.some(segment => segment.x === food.x && segment.y === food.y));
        }

        // Main game loop
        function gameStep() {
            if(!gameRunning) return;

            const head = {x: snake[0].x + direction.x, y: snake[0].y + direction.y};

            // Check wall collision
            if(head.x < 0 || head.x >= GRID_SIZE || head.y < 0 || head.y >= GRID_SIZE) {
                endGame();
                return;
            }

            // Check self collision
            if(snake.some(segment => segment.x === head.x && segment.y === head.y)) {
                endGame();
                return;
            }

            snake.unshift(head);

            // Check if food eaten
            if(head.x === food.x && head.y === food.y) {
                score += 10;
                if(score > highScore) {
                    highScore = score;
                    localStorage.setItem('snakeHighScore', highScore.toString());
                    highScoreElement.textContent = highScore;
                }
                generateFood();
            } else {
                snake.pop();
            }

            updateDisplay();
        }

        // Start the game
        function startGame() {
            console.log('Starting game...');
            
            // Reset game state
            snake = [{x: 10, y: 10}];
            direction = {x: 0, y: -1};
            score = 0;
            gameRunning = true;
            
            // Generate initial food
            generateFood();
            
            // Update UI
            startBtn.style.display = 'none';
            resetBtn.style.display = 'inline-block';
            gameOverDiv.style.display = 'none';
            
            // Create grid and update display
            createGrid();
            updateDisplay();
            
            // Start game loop
            if(gameLoop) clearInterval(gameLoop);
            gameLoop = setInterval(gameStep, 200);
            
            console.log('Game started!');
        }

        // End the game
        function endGame() {
            console.log('Game ended');
            gameRunning = false;
            if(gameLoop) {
                clearInterval(gameLoop);
                gameLoop = null;
            }
            
            finalScoreElement.textContent = score;
            gameOverDiv.style.display = 'block';
            resetBtn.style.display = 'inline-block';
        }

        // Reset to menu
        function resetGame() {
            console.log('Resetting game...');
            gameRunning = false;
            if(gameLoop) {
                clearInterval(gameLoop);
                gameLoop = null;
            }
            
            startBtn.style.display = 'inline-block';
            resetBtn.style.display = 'none';
            gameOverDiv.style.display = 'none';
            
            createGrid();
        }

        // Change direction
        function changeDirection(x, y) {
            if(!gameRunning) return;
            
            // Prevent reverse direction
            if(direction.x === -x && direction.y === -y) return;
            
            direction = {x, y};
            console.log('Direction changed to:', direction);
        }

        // Event listeners
        startBtn.addEventListener('click', startGame);
        resetBtn.addEventListener('click', resetGame);
        playAgainBtn.addEventListener('click', startGame);

        // Mobile controls
        upBtn.addEventListener('click', () => changeDirection(0, -1));
        downBtn.addEventListener('click', () => changeDirection(0, 1));
        leftBtn.addEventListener('click', () => changeDirection(-1, 0));
        rightBtn.addEventListener('click', () => changeDirection(1, 0));

        // Keyboard controls
        document.addEventListener('keydown', (e) => {
            if(!gameRunning) return;
            
            switch(e.key) {
                case 'ArrowUp':
                case 'w':
                case 'W':
                    e.preventDefault();
                    changeDirection(0, -1);
                    break;
                case 'ArrowDown':
                case 's':
                case 'S':
                    e.preventDefault();
                    changeDirection(0, 1);
                    break;
                case 'ArrowLeft':
                case 'a':
                case 'A':
                    e.preventDefault();
                    changeDirection(-1, 0);
                    break;
                case 'ArrowRight':
                case 'd':
                case 'D':
                    e.preventDefault();
                    changeDirection(1, 0);
                    break;
            }
        });

        // Prevent page scrolling with arrow keys
        window.addEventListener("keydown", function(e) {
            if(["Space","ArrowUp","ArrowDown","ArrowLeft","ArrowRight"].indexOf(e.code) > -1) {
                e.preventDefault();
            }
        }, false);

        // Initialize the game
        console.log('Initializing game...');
        createGrid();
        console.log('Game initialized!');
    </script>
</body>
</html>